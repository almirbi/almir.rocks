window.addEventListener("load",()=>{function e(){window.removeEventListener("scroll",e);let t=document.querySelector("#game-wrapper .icons"),n=["angularjs","apache","bootstrap","bower","c","cplusplus","csharp","css3","vagrant","debian","docker","dot-net","html5","jasmine","javascript","jquery","mongodb","mysql","nginx","php-flat","react","typescript","ubuntu","wordpress"];mobilecheck()&&n.splice(14);let a;n.forEach((e,r)=>{r%parseInt(n.length/3)!=0&&0!==r||(a=document.createElement("br"),t.appendChild(a));let s=document.createElement("img"),o=document.createElement("div");o.className="icon alive",s.alt=e,s.title=e,s.src="assets/images/"+e+".svg",o.dataset.name=e,o.appendChild(s),t.appendChild(o)});new Game}mobilecheck()&&document.querySelector("span.strikethrough").style.setProperty("outline-offset","-12px");let t=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},n=document.getElementById("contact-form"),a=document.querySelector(".spinner");document.getElementById("sendMessage").addEventListener("click",()=>{setTimeout(()=>{document.querySelector("#contact > .container").scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},200)}),n.addEventListener("submit",e=>{e.preventDefault();var n=new XMLHttpRequest;let r={c_name:e.target.c_name.value,c_message:e.target.c_message.value,c_email:e.target.c_email.value};var s=t(r);return n.open("POST","/assets/php/handleFormSubmit.php",!0),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){if(4==n.readyState&&200==n.status){let e=document.querySelector(".ajax-response");e.innerHTML=JSON.parse(n.responseText).message,e.classList.add("active")}a.classList.remove("active")},n.send(s),a.classList.add("active"),!1}),window.addEventListener("scroll",e),[...document.querySelectorAll("img")].forEach(e=>{e.dataset.src&&(e.src=e.dataset.src)})},!1),window.addEventListener("resize",()=>{requestAnimationFrame(resizeHomeSection)});let links=[...document.querySelectorAll("a[href^='#'")];links.forEach(e=>{e.addEventListener("click",t=>(t.preventDefault(),document.querySelector(e.getAttribute("href")).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"}),!1))});


function preventDefault(t){(t=t||window.event).preventDefault&&t.preventDefault(),t.returnValue=!1}function preventDefaultForScrollKeys(t){if(keys[t.keyCode])return preventDefault(t),!1}function disableScroll(){window.addEventListener&&window.addEventListener("DOMMouseScroll",preventDefault,!1),window.onwheel=preventDefault,window.onmousewheel=document.onmousewheel=preventDefault,window.ontouchmove=preventDefault,document.onkeydown=preventDefaultForScrollKeys}function enableScroll(){window.removeEventListener&&window.removeEventListener("DOMMouseScroll",preventDefault,!1),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null,document.onkeydown=null}const State={PAUSED:"paused",VIRGIN:"virgin",RUNNING:"running",LOST:"lost",WIN:"win"};window.mobilecheck=function(){var t=!1;return function(e){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t=!0)}(navigator.userAgent||navigator.vendor||window.opera),t};var keys={37:1,38:1,39:1,40:1};const DEFAULT_SPEED=mobilecheck()?4:8;console.log(`Speed set to ${DEFAULT_SPEED}`);class Game{constructor(){this.ball=document.getElementById("ball"),this.pad=document.getElementById("pad"),this.gameWindow=document.getElementById("game-wrapper"),this.bricks=this.getBricks(),this.isDragging=!1,this.direction={x:1,y:1},this.state=State.VIRGIN,this.settings={ballSpeed:DEFAULT_SPEED},this.isFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,mobilecheck()?(this.pad.addEventListener("touchstart",this.handleStart.bind(this),!1),document.addEventListener("touchend",this.handleEnd.bind(this),!1),document.addEventListener("touchcancel",this.handleEnd.bind(this),!1)):(document.addEventListener("mouseup",this.handleEnd.bind(this),!1),this.pad.addEventListener("mousedown",this.handleStart.bind(this),!1))}getBricks(){return Array.prototype.slice.call(this.gameWindow.querySelectorAll(".icons > .icon"))}attachEventListeners(){document.addEventListener("touchmove",this.handleMove.bind(this),!1),document.addEventListener("mousemove",this.handleMove.bind(this),!1)}deattachEventListeners(){document.removeEventListener("touchmove",this.handleMove,!1),document.removeEventListener("mousemove",this.handleMove,!1)}handleMove(t){if(this.isDragging){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1;let{x:e,y:i}=this.getWindowDimensions(),s="";s=(t.clientX||t.touches[0].clientX)-(e-this.gameWindow.offsetWidth)/2+"px",this.pad.style.setProperty("left",s)}return!1}handleEnd(t){this.isDragging&&(0!=t.button&&void 0!==t.button||(this.isDragging=!1,this.removeMessageTimeout&&clearTimeout(this.removeMessageTimeout),this.deattachEventListeners(),enableScroll(),this.gameWindow.classList.add("paused"),this.slowBallDown(()=>{this.isDragging?this.startMovingSmooth(()=>{this.play()}):this.pauseGame()})))}handleStart(t){if(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.cancelBubble=!0,t.returnValue=!1,0==t.button||void 0===t.button)switch(this.isDragging=!0,this.attachEventListeners(),this.removeMessageTimeout=setTimeout(()=>{let t=document.querySelector(".explanation-wrapper"),e=t.querySelector("span > img");if(!e)return;let i=t.querySelector("span > span");t.style.setProperty("height",t.offsetHeight+"px"),e.parentElement.removeChild(e),i.innerHTML="Release to pause"},3e3),disableScroll(),this.state){case State.VIRGIN:this.gameWindow.className="",this.launchBall();break;case State.LOST:this.resetGame();break;case State.PAUSED:this.startMovingSmooth(()=>{this.play()})}return!1}getWindowDimensions(){let t=window,e=document,i=e.documentElement,s=e.getElementsByTagName("body")[0];return{x:t.innerWidth||i.clientWidth||s.clientWidth,y:t.innerHeight||i.clientHeight||s.clientHeight}}launchBall(){this.play(),this.moveBall()}getElementOffsetTop(t){let e=getComputedStyle(this.gameWindow),i=parseInt(e["border-top-width"]);return this.isFirefox?t.offsetTop-i:t.offsetTop}getElementOffsetLeft(t){let e=getComputedStyle(this.gameWindow),i=parseInt(e["border-left-width"]);return this.isFirefox?t.offsetLeft-i:t.offsetLeft}resetGame(){this.state==State.LOST&&(this.gameWindow.classList.remove("lost"),this.ball.style.display="block",this.ball.style.left=this.getElementOffsetLeft(this.pad)+(this.pad.offsetWidth-this.ball.offsetWidth/2)+"px",this.ball.style.top=this.getElementOffsetTop(this.pad.parentElement)-this.ball.offsetHeight+"px",this.state=State.RUNNING,this.gameWindow.className="",this.settings.ballSpeed=DEFAULT_SPEED,this.direction={x:1,y:1},this.launchBall())}endGame(){this.state=State.LOST,this.gameWindow.classList.add("lost"),this.ball.style.display="none"}slowBallDown(t){let e=setInterval(()=>{if(0==this.settings.ballSpeed--||this.isDragging)return clearInterval(e),void t()},100)}startMovingSmooth(t){if(t(),this.settings.ballSpeed==DEFAULT_SPEED)return;let e=setInterval(()=>{if(this.settings.ballSpeed++>=5)return clearInterval(e),this.settings.ballSpeed=DEFAULT_SPEED,void this.gameWindow.classList.remove("paused")},100)}pauseGame(){this.state==State.RUNNING&&(this.state=State.PAUSED)}play(){this.state=State.RUNNING}collision(t,e,i=!0){let s,o;i?(s={radius:t.offsetHeight/2,x:this.getElementOffsetLeft(t)+t.offsetHeight/2,y:this.gameWindow.offsetHeight-this.getElementOffsetTop(t)-t.offsetWidth/2},o={radius:e.offsetWidth/2,x:this.getElementOffsetLeft(e)+e.offsetWidth/2,y:this.gameWindow.offsetHeight-this.getElementOffsetTop(e)-e.offsetWidth/2}):(s=t,o=e);var n=s.x-o.x,a=s.y-o.y;let l=Math.sqrt(n*n+a*a)<=s.radius+o.radius;return s.x-=o.x,s.y-=o.y,!!l&&{x:s.x/Math.abs(s.x),y:s.y/Math.abs(s.y)}}blinkBorder(t){if("pad"==t)return;let e=t.toLowerCase();e=e.charAt(0).toUpperCase()+e.slice(1),this.gameWindow.style["border"+e+"Color"]="grey",setTimeout(()=>{this.gameWindow.style["border"+e+"Color"]="transparent"},1e3)}bounce(){let t=this.gameWindow.offsetWidth,e=this.gameWindow.offsetHeight;if(this.pad.parentElement.offsetTop+10<this.ball.offsetTop+this.ball.offsetHeight)throw"Lost";return this.getElementOffsetLeft(this.ball)<=0&&-1===this.direction.x?(this.ball.style.setProperty("left",0),this.direction.x=1,"left"):this.getElementOffsetTop(this.ball)<=0&&1===this.direction.y?(this.ball.style.setProperty("top",0),this.direction.y=-1,"top"):this.getElementOffsetLeft(this.ball)>=t-parseInt(this.ball.offsetWidth)&&1===this.direction.x?(this.ball.style.setProperty("top",e-parseInt(this.ball.offsetHeight)),this.direction.x=-1,"right"):this.getElementOffsetTop(this.ball)+21>=e-parseInt(this.ball.offsetHeight)&&-1===this.direction.y&&this.getElementOffsetLeft(this.ball)>this.getElementOffsetLeft(this.pad)-this.ball.offsetWidth-5&&this.getElementOffsetLeft(this.ball)<this.getElementOffsetLeft(this.pad)+this.pad.offsetWidth&&(this.direction.y=1,console.log("pad!!!"),"pad")}killBrick(t){t.classList.remove("alive");let e;for(let t=0;t<this.bricks.length;t++)if(!this.bricks[t].classList.contains("alive")){e=t;break}this.bricks.splice(e,1),ga("send",{hitType:"event",eventCategory:"Game",eventAction:"broken",eventLabel:"Brick Hits",eventValue:t.dataset.name})}victory(){this.state=State.WIN;let t=this.ball.querySelector("i");t.parentElement.removeChild(t),this.ball.style.setProperty("background-image","url('/assets/images/victory.jpg')"),this.ball.style.setProperty("background-size","contain"),this.ball.classList.add("victory"),document.querySelector(".explanation-wrapper").querySelector("span > span").innerHTML="V is for Viiictory!"}moveBall(){try{if(this.state==State.WIN)return;if(this.state==State.PAUSED)return void requestAnimationFrame(()=>{this.moveBall()});for(let t=0;t<this.settings.ballSpeed;t++){let t=this.bounce();t&&this.blinkBorder(t);let e=this.getElementOffsetLeft(this.ball)+this.direction.x+"px",i=this.getElementOffsetTop(this.ball)+-1*this.direction.y+"px";this.ball.style.setProperty("left",e),this.ball.style.setProperty("top",i);let s=this.getElementOffsetTop(this.ball),o=document.querySelector("div.icons .icon:last-child");s<this.getElementOffsetTop(o)+o.offsetHeight&&this.bricks.forEach(t=>{let e=this.collision(this.ball,t);(e.x||e.y)&&(this.settings.ballSpeed===DEFAULT_SPEED&&(this.killBrick(t),0===this.bricks.length&&this.victory()),e.x&&(this.direction.x=e.x),e.y&&(this.direction.y=e.y))})}requestAnimationFrame(()=>{this.moveBall()})}catch(t){if("Lost"!==t)throw this.endGame(),t;this.endGame()}}}


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImN1c3RvbS5qcyIsImdhbWUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBO0FDRkE7QUFDQTtBQUNBIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcblxuICBpZiAobW9iaWxlY2hlY2soKSkge1xuICAgIGxldCBzdHJpa2V0aHJvdWdoID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcInNwYW4uc3RyaWtldGhyb3VnaFwiKTtcbiAgICBzdHJpa2V0aHJvdWdoLnN0eWxlLnNldFByb3BlcnR5KFwib3V0bGluZS1vZmZzZXRcIiwgXCItMTJweFwiKTtcbiAgfVxuICBcblxuICBmdW5jdGlvbiBzdGFydEdhbWUoKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHN0YXJ0R2FtZSk7XG4gICAgXG4gICAgbGV0IGljb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNnYW1lLXdyYXBwZXIgLmljb25zXCIpO1xuICAgIGxldCB0ZWNocyA9IFtcImFuZ3VsYXJqc1wiLCBcImFwYWNoZVwiLCBcImJvb3RzdHJhcFwiLCBcImJvd2VyXCIsIFwiY1wiLCBcImNwbHVzcGx1c1wiLCBcImNzaGFycFwiLCBcImNzczNcIiwgXCJ2YWdyYW50XCIsIFwiZGViaWFuXCIsIFwiZG9ja2VyXCIsIFwiZG90LW5ldFwiLCBcImh0bWw1XCIsIFwiamFzbWluZVwiLCBcImphdmFzY3JpcHRcIiwgXCJqcXVlcnlcIiwgXCJtb25nb2RiXCIsIFwibXlzcWxcIiwgXCJuZ2lueFwiLCBcInBocC1mbGF0XCIsIFwicmVhY3RcIiwgXCJ0eXBlc2NyaXB0XCIsIFwidWJ1bnR1XCIsIFwid29yZHByZXNzXCJdO1xuICAgIGlmIChtb2JpbGVjaGVjaygpKSB7XG4gICAgICB0ZWNocy5zcGxpY2UoMTQpO1xuICAgIH1cbiAgXG4gICAgbGV0IGRpdlJvdztcbiAgXG4gICAgdGVjaHMuZm9yRWFjaCgodGVjaCwgaW5kZXgpID0+IHtcbiAgXG4gICAgICBpZiAoaW5kZXggJSBwYXJzZUludCh0ZWNocy5sZW5ndGgvMykgPT09IDAgfHwgaW5kZXggPT09IDApIHtcbiAgICAgICAgZGl2Um93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJyXCIpO1xuICAgICAgICBpY29ucy5hcHBlbmRDaGlsZChkaXZSb3cpO1xuICAgICAgfVxuICBcbiAgICAgIGxldCBpbWFnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbWdcIik7XG4gICAgICBsZXQgaWNvbldyYXAgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgaWNvbldyYXAuY2xhc3NOYW1lID0gXCJpY29uIGFsaXZlXCI7XG4gICAgICBpbWFnZS5hbHQgPSB0ZWNoO1xuICAgICAgaW1hZ2UudGl0bGUgPSB0ZWNoO1xuICAgICAgaW1hZ2Uuc3JjID0gXCJhc3NldHMvaW1hZ2VzL1wiICsgdGVjaCArIFwiLnN2Z1wiO1xuICAgICAgaWNvbldyYXAuZGF0YXNldC5uYW1lID0gdGVjaDtcbiAgXG4gICAgICBpY29uV3JhcC5hcHBlbmRDaGlsZChpbWFnZSk7XG4gICAgICBpY29ucy5hcHBlbmRDaGlsZChpY29uV3JhcCk7XG4gICAgfSk7XG4gIFxuICAgIGxldCBhd2Vzb21lR2FtZSA9IG5ldyBHYW1lKCk7XG4gIH1cblxuICBsZXQgb2JqZWN0VG9RdWVyeVN0cmluZyA9IGZ1bmN0aW9uKG9iaikge1xuICAgIHZhciBzdHIgPSBbXTtcbiAgICBmb3IodmFyIHAgaW4gb2JqKVxuICAgICAgaWYgKG9iai5oYXNPd25Qcm9wZXJ0eShwKSkge1xuICAgICAgICBzdHIucHVzaChlbmNvZGVVUklDb21wb25lbnQocCkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChvYmpbcF0pKTtcbiAgICAgIH1cbiAgICByZXR1cm4gc3RyLmpvaW4oXCImXCIpO1xuICB9XG5cbiAgbGV0IGNvbnRhY3RGb3JtID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjb250YWN0LWZvcm1cIik7XG4gIGxldCBsb2FkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnNwaW5uZXJcIik7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZW5kTWVzc2FnZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2NvbnRhY3QgPiAuY29udGFpbmVyJykuc2Nyb2xsSW50b1ZpZXcoe2JlaGF2aW9yOiBcInNtb290aFwiLCBibG9jazogXCJzdGFydFwiLCBpbmxpbmU6IFwibmVhcmVzdFwifSk7XG4gICAgfSwgMjAwKTtcbiAgfSk7XG4gIGNvbnRhY3RGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2ZW50KSA9PiB7XG4gICAgXG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB2YXIgaHR0cCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHZhciB1cmwgPSBcIi9hc3NldHMvcGhwL2hhbmRsZUZvcm1TdWJtaXQucGhwXCI7XG4gICAgbGV0IHBvc3QgPSB7XG4gICAgICBjX25hbWUgOiBldmVudC50YXJnZXQuY19uYW1lLnZhbHVlLFxuICAgICAgY19tZXNzYWdlOiBldmVudC50YXJnZXQuY19tZXNzYWdlLnZhbHVlLFxuICAgICAgY19lbWFpbDogZXZlbnQudGFyZ2V0LmNfZW1haWwudmFsdWVcbiAgICB9O1xuICAgIHZhciBwYXJhbXMgPSBvYmplY3RUb1F1ZXJ5U3RyaW5nKHBvc3QpO1xuICAgIGh0dHAub3BlbihcIlBPU1RcIiwgdXJsLCB0cnVlKTtcbiAgICBcbiAgICAvL1NlbmQgdGhlIHByb3BlciBoZWFkZXIgaW5mb3JtYXRpb24gYWxvbmcgd2l0aCB0aGUgcmVxdWVzdFxuICAgIGh0dHAuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtdHlwZVwiLCBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiKTtcbiAgICBcbiAgICBodHRwLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgey8vQ2FsbCBhIGZ1bmN0aW9uIHdoZW4gdGhlIHN0YXRlIGNoYW5nZXMuXG4gICAgICAgIGlmKGh0dHAucmVhZHlTdGF0ZSA9PSA0ICYmIGh0dHAuc3RhdHVzID09IDIwMCkge1xuICAgICAgICAgIGxldCByZXNwb25zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWpheC1yZXNwb25zZVwiKTtcbiAgICAgICAgICByZXNwb25zZS5pbm5lckhUTUwgPSBKU09OLnBhcnNlKGh0dHAucmVzcG9uc2VUZXh0KS5tZXNzYWdlO1xuICAgICAgICAgIHJlc3BvbnNlLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgICAgICB9XG4gICAgICAgIGxvYWRlci5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTtcbiAgICB9XG4gICAgaHR0cC5zZW5kKHBhcmFtcyk7XG4gICAgXG4gICAgbG9hZGVyLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpO1xuICAgIFxuICAgIHJldHVybiBmYWxzZTtcbiAgfSk7XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Njcm9sbCcsIHN0YXJ0R2FtZSk7XG5cbiAgbGV0IGltYWdlcyA9IFsuLi5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdpbWcnKV07XG4gIGltYWdlcy5mb3JFYWNoKChpbWFnZSkgPT4ge1xuICAgIGlmIChpbWFnZS5kYXRhc2V0LnNyYykge1xuICAgICAgaW1hZ2Uuc3JjID0gaW1hZ2UuZGF0YXNldC5zcmM7XG4gICAgfVxuICB9KTtcblx0XG59LCBmYWxzZSk7XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsICgpID0+IHtcbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHJlc2l6ZUhvbWVTZWN0aW9uKTtcbn0pO1xuXG5sZXQgbGlua3MgPSBbLi4uZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcImFbaHJlZl49JyMnXCIpXTtcbmxpbmtzLmZvckVhY2gobGluayA9PiB7XG4gIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50ID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobGluay5nZXRBdHRyaWJ1dGUoJ2hyZWYnKSkuc2Nyb2xsSW50b1ZpZXcoe2JlaGF2aW9yOiBcInNtb290aFwiLCBibG9jazogXCJzdGFydFwiLCBpbmxpbmU6IFwibmVhcmVzdFwifSk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcbn0pO1xuIiwiY29uc3QgU3RhdGUgPSB7XG4gIFBBVVNFRDogJ3BhdXNlZCcsXG4gIFZJUkdJTjogJ3ZpcmdpbicsXG4gIFJVTk5JTkc6ICdydW5uaW5nJyxcbiAgTE9TVDogJ2xvc3QnLFxuICBXSU46ICd3aW4nXG59O1xuXG53aW5kb3cubW9iaWxlY2hlY2sgPSBmdW5jdGlvbigpIHtcbiAgdmFyIGNoZWNrID0gZmFsc2U7XG4gIChmdW5jdGlvbihhKXtpZigvKGFuZHJvaWR8YmJcXGQrfG1lZWdvKS4rbW9iaWxlfGF2YW50Z298YmFkYVxcL3xibGFja2JlcnJ5fGJsYXplcnxjb21wYWx8ZWxhaW5lfGZlbm5lY3xoaXB0b3B8aWVtb2JpbGV8aXAoaG9uZXxvZCl8aXJpc3xraW5kbGV8bGdlIHxtYWVtb3xtaWRwfG1tcHxtb2JpbGUuK2ZpcmVmb3h8bmV0ZnJvbnR8b3BlcmEgbShvYnxpbilpfHBhbG0oIG9zKT98cGhvbmV8cChpeGl8cmUpXFwvfHBsdWNrZXJ8cG9ja2V0fHBzcHxzZXJpZXMoNHw2KTB8c3ltYmlhbnx0cmVvfHVwXFwuKGJyb3dzZXJ8bGluayl8dm9kYWZvbmV8d2FwfHdpbmRvd3MgY2V8eGRhfHhpaW5vL2kudGVzdChhKXx8LzEyMDd8NjMxMHw2NTkwfDNnc298NHRocHw1MFsxLTZdaXw3NzBzfDgwMnN8YSB3YXxhYmFjfGFjKGVyfG9vfHNcXC0pfGFpKGtvfHJuKXxhbChhdnxjYXxjbyl8YW1vaXxhbihleHxueXx5dyl8YXB0dXxhcihjaHxnbyl8YXModGV8dXMpfGF0dHd8YXUoZGl8XFwtbXxyIHxzICl8YXZhbnxiZShja3xsbHxucSl8YmkobGJ8cmQpfGJsKGFjfGF6KXxicihlfHYpd3xidW1ifGJ3XFwtKG58dSl8YzU1XFwvfGNhcGl8Y2N3YXxjZG1cXC18Y2VsbHxjaHRtfGNsZGN8Y21kXFwtfGNvKG1wfG5kKXxjcmF3fGRhKGl0fGxsfG5nKXxkYnRlfGRjXFwtc3xkZXZpfGRpY2F8ZG1vYnxkbyhjfHApb3xkcygxMnxcXC1kKXxlbCg0OXxhaSl8ZW0obDJ8dWwpfGVyKGljfGswKXxlc2w4fGV6KFs0LTddMHxvc3x3YXx6ZSl8ZmV0Y3xmbHkoXFwtfF8pfGcxIHV8ZzU2MHxnZW5lfGdmXFwtNXxnXFwtbW98Z28oXFwud3xvZCl8Z3IoYWR8dW4pfGhhaWV8aGNpdHxoZFxcLShtfHB8dCl8aGVpXFwtfGhpKHB0fHRhKXxocCggaXxpcCl8aHNcXC1jfGh0KGMoXFwtfCB8X3xhfGd8cHxzfHQpfHRwKXxodShhd3x0Yyl8aVxcLSgyMHxnb3xtYSl8aTIzMHxpYWMoIHxcXC18XFwvKXxpYnJvfGlkZWF8aWcwMXxpa29tfGltMWt8aW5ub3xpcGFxfGlyaXN8amEodHx2KWF8amJyb3xqZW11fGppZ3N8a2RkaXxrZWppfGtndCggfFxcLyl8a2xvbnxrcHQgfGt3Y1xcLXxreW8oY3xrKXxsZShub3x4aSl8bGcoIGd8XFwvKGt8bHx1KXw1MHw1NHxcXC1bYS13XSl8bGlid3xseW54fG0xXFwtd3xtM2dhfG01MFxcL3xtYSh0ZXx1aXx4byl8bWMoMDF8MjF8Y2EpfG1cXC1jcnxtZShyY3xyaSl8bWkobzh8b2F8dHMpfG1tZWZ8bW8oMDF8MDJ8Yml8ZGV8ZG98dChcXC18IHxvfHYpfHp6KXxtdCg1MHxwMXx2ICl8bXdicHxteXdhfG4xMFswLTJdfG4yMFsyLTNdfG4zMCgwfDIpfG41MCgwfDJ8NSl8bjcoMCgwfDEpfDEwKXxuZSgoY3xtKVxcLXxvbnx0Znx3Znx3Z3x3dCl8bm9rKDZ8aSl8bnpwaHxvMmltfG9wKHRpfHd2KXxvcmFufG93ZzF8cDgwMHxwYW4oYXxkfHQpfHBkeGd8cGcoMTN8XFwtKFsxLThdfGMpKXxwaGlsfHBpcmV8cGwoYXl8dWMpfHBuXFwtMnxwbyhja3xydHxzZSl8cHJveHxwc2lvfHB0XFwtZ3xxYVxcLWF8cWMoMDd8MTJ8MjF8MzJ8NjB8XFwtWzItN118aVxcLSl8cXRla3xyMzgwfHI2MDB8cmFrc3xyaW05fHJvKHZlfHpvKXxzNTVcXC98c2EoZ2V8bWF8bW18bXN8bnl8dmEpfHNjKDAxfGhcXC18b298cFxcLSl8c2RrXFwvfHNlKGMoXFwtfDB8MSl8NDd8bWN8bmR8cmkpfHNnaFxcLXxzaGFyfHNpZShcXC18bSl8c2tcXC0wfHNsKDQ1fGlkKXxzbShhbHxhcnxiM3xpdHx0NSl8c28oZnR8bnkpfHNwKDAxfGhcXC18dlxcLXx2ICl8c3koMDF8bWIpfHQyKDE4fDUwKXx0NigwMHwxMHwxOCl8dGEoZ3R8bGspfHRjbFxcLXx0ZGdcXC18dGVsKGl8bSl8dGltXFwtfHRcXC1tb3x0byhwbHxzaCl8dHMoNzB8bVxcLXxtM3xtNSl8dHhcXC05fHVwKFxcLmJ8ZzF8c2kpfHV0c3R8djQwMHx2NzUwfHZlcml8dmkocmd8dGUpfHZrKDQwfDVbMC0zXXxcXC12KXx2bTQwfHZvZGF8dnVsY3x2eCg1Mnw1M3w2MHw2MXw3MHw4MHw4MXw4M3w4NXw5OCl8dzNjKFxcLXwgKXx3ZWJjfHdoaXR8d2koZyB8bmN8bncpfHdtbGJ8d29udXx4NzAwfHlhc1xcLXx5b3VyfHpldG98enRlXFwtL2kudGVzdChhLnN1YnN0cigwLDQpKSkgY2hlY2sgPSB0cnVlO30pKG5hdmlnYXRvci51c2VyQWdlbnR8fG5hdmlnYXRvci52ZW5kb3J8fHdpbmRvdy5vcGVyYSk7XG4gIHJldHVybiBjaGVjaztcbn07XG5cbi8vIGxlZnQ6IDM3LCB1cDogMzgsIHJpZ2h0OiAzOSwgZG93bjogNDAsXG4vLyBzcGFjZWJhcjogMzIsIHBhZ2V1cDogMzMsIHBhZ2Vkb3duOiAzNCwgZW5kOiAzNSwgaG9tZTogMzZcbnZhciBrZXlzID0gezM3OiAxLCAzODogMSwgMzk6IDEsIDQwOiAxfTtcblxuZnVuY3Rpb24gcHJldmVudERlZmF1bHQoZSkge1xuICBlID0gZSB8fCB3aW5kb3cuZXZlbnQ7XG4gIGlmIChlLnByZXZlbnREZWZhdWx0KVxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBlLnJldHVyblZhbHVlID0gZmFsc2U7ICBcbn1cblxuZnVuY3Rpb24gcHJldmVudERlZmF1bHRGb3JTY3JvbGxLZXlzKGUpIHtcbiAgICBpZiAoa2V5c1tlLmtleUNvZGVdKSB7XG4gICAgICAgIHByZXZlbnREZWZhdWx0KGUpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkaXNhYmxlU2Nyb2xsKCkge1xuICBpZiAod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpIC8vIG9sZGVyIEZGXG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NTW91c2VTY3JvbGwnLCBwcmV2ZW50RGVmYXVsdCwgZmFsc2UpO1xuICB3aW5kb3cub253aGVlbCA9IHByZXZlbnREZWZhdWx0OyAvLyBtb2Rlcm4gc3RhbmRhcmRcbiAgd2luZG93Lm9ubW91c2V3aGVlbCA9IGRvY3VtZW50Lm9ubW91c2V3aGVlbCA9IHByZXZlbnREZWZhdWx0OyAvLyBvbGRlciBicm93c2VycywgSUVcbiAgd2luZG93Lm9udG91Y2htb3ZlICA9IHByZXZlbnREZWZhdWx0OyAvLyBtb2JpbGVcbiAgZG9jdW1lbnQub25rZXlkb3duICA9IHByZXZlbnREZWZhdWx0Rm9yU2Nyb2xsS2V5cztcbn1cblxuZnVuY3Rpb24gZW5hYmxlU2Nyb2xsKCkge1xuICAgIGlmICh3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcilcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ0RPTU1vdXNlU2Nyb2xsJywgcHJldmVudERlZmF1bHQsIGZhbHNlKTtcbiAgICB3aW5kb3cub25tb3VzZXdoZWVsID0gZG9jdW1lbnQub25tb3VzZXdoZWVsID0gbnVsbDsgXG4gICAgd2luZG93Lm9ud2hlZWwgPSBudWxsOyBcbiAgICB3aW5kb3cub250b3VjaG1vdmUgPSBudWxsOyAgXG4gICAgZG9jdW1lbnQub25rZXlkb3duID0gbnVsbDsgIFxufVxuXG5jb25zdCBERUZBVUxUX1NQRUVEID0gbW9iaWxlY2hlY2soKSA/IDQgOiA4O1xuXG5jb25zb2xlLmxvZyhgU3BlZWQgc2V0IHRvICR7REVGQVVMVF9TUEVFRH1gKTtcblxuY2xhc3MgR2FtZSB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYmFsbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYmFsbFwiKTtcbiAgICB0aGlzLnBhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicGFkXCIpO1xuICAgIHRoaXMuZ2FtZVdpbmRvdyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZ2FtZS13cmFwcGVyXCIpO1xuICAgIHRoaXMuYnJpY2tzID0gdGhpcy5nZXRCcmlja3MoKTtcbiAgICB0aGlzLmlzRHJhZ2dpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmRpcmVjdGlvbiA9IHtcbiAgICAgIHg6IDEsXG4gICAgICB5OiAxXG4gICAgfTtcbiAgICB0aGlzLnN0YXRlID0gU3RhdGUuVklSR0lOO1xuICAgIHRoaXMuc2V0dGluZ3MgPSB7XG4gICAgICBiYWxsU3BlZWQ6IERFRkFVTFRfU1BFRURcbiAgICB9O1xuICAgIHRoaXMuaXNGaXJlZm94ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2ZpcmVmb3gnKSA+IC0xO1xuXG4gICAgaWYgKG1vYmlsZWNoZWNrKCkpIHtcbiAgICAgIHRoaXMucGFkLmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaHN0YXJ0XCIsIHRoaXMuaGFuZGxlU3RhcnQuYmluZCh0aGlzKSwgZmFsc2UpO1xuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNoZW5kXCIsIHRoaXMuaGFuZGxlRW5kLmJpbmQodGhpcyksIGZhbHNlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJ0b3VjaGNhbmNlbFwiLCB0aGlzLmhhbmRsZUVuZC5iaW5kKHRoaXMpLCBmYWxzZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuaGFuZGxlRW5kLmJpbmQodGhpcyksIGZhbHNlKTtcbiAgICAgIHRoaXMucGFkLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5oYW5kbGVTdGFydC5iaW5kKHRoaXMpLCBmYWxzZSk7XG4gICAgfVxuICAgIFxuICB9XG5cbiAgZ2V0QnJpY2tzKCkge1xuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0aGlzLmdhbWVXaW5kb3cucXVlcnlTZWxlY3RvckFsbChcIi5pY29ucyA+IC5pY29uXCIpKVxuICB9XG5cbiAgYXR0YWNoRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCB0aGlzLmhhbmRsZU1vdmUuYmluZCh0aGlzKSwgZmFsc2UpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy5oYW5kbGVNb3ZlLmJpbmQodGhpcyksIGZhbHNlKTtcbiAgfVxuXG4gIGRlYXR0YWNoRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInRvdWNobW92ZVwiLCB0aGlzLmhhbmRsZU1vdmUsIGZhbHNlKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMuaGFuZGxlTW92ZSwgZmFsc2UpO1xuICB9XG5cbiAgaGFuZGxlTW92ZShldmVudCkge1xuICAgIGlmICh0aGlzLmlzRHJhZ2dpbmcpIHtcbiAgICAgICAgaWYoZXZlbnQuc3RvcFByb3BhZ2F0aW9uKSB7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgICBpZihldmVudC5wcmV2ZW50RGVmYXVsdCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfVxuICAgICAgICBldmVudC5jYW5jZWxCdWJibGUgPSB0cnVlO1xuICAgICAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xuICAgICAgXG4gICAgICBsZXQge3gsIHl9ID0gdGhpcy5nZXRXaW5kb3dEaW1lbnNpb25zKCksXG4gICAgICAgIGxlZnQgPSBcIlwiLCBjbGllbnRYID0gZXZlbnQuY2xpZW50WCB8fCBldmVudC50b3VjaGVzWzBdLmNsaWVudFg7XG4gICAgICBsZWZ0ID0gKGNsaWVudFggLSAoKHggLSB0aGlzLmdhbWVXaW5kb3cub2Zmc2V0V2lkdGgpLzIpKSArIFwicHhcIlxuICAgICAgdGhpcy5wYWQuc3R5bGUuc2V0UHJvcGVydHkoXCJsZWZ0XCIsIGxlZnQpO1xuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBoYW5kbGVFbmQoZXZlbnQpIHtcbiAgICBpZiAoIXRoaXMuaXNEcmFnZ2luZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZXZlbnQuYnV0dG9uID09IDAgfHwgZXZlbnQuYnV0dG9uID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHRoaXMuaXNEcmFnZ2luZyA9IGZhbHNlO1xuICAgICAgaWYgKHRoaXMucmVtb3ZlTWVzc2FnZVRpbWVvdXQpIHtcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMucmVtb3ZlTWVzc2FnZVRpbWVvdXQpO1xuICAgICAgfVxuICAgICAgdGhpcy5kZWF0dGFjaEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgICBlbmFibGVTY3JvbGwoKTtcbiAgICAgIHRoaXMuZ2FtZVdpbmRvdy5jbGFzc0xpc3QuYWRkKFwicGF1c2VkXCIpO1xuICAgICAgdGhpcy5zbG93QmFsbERvd24oKCkgPT4ge1xuICAgICAgICBpZiAoICEgdGhpcy5pc0RyYWdnaW5nICkge1xuICAgICAgICAgIHRoaXMucGF1c2VHYW1lKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5zdGFydE1vdmluZ1Ntb290aCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnBsYXkoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlU3RhcnQoZXZlbnQpIHtcblxuICAgIGlmKGV2ZW50LnN0b3BQcm9wYWdhdGlvbikge1xuICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG4gICAgaWYoZXZlbnQucHJldmVudERlZmF1bHQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gICAgZXZlbnQuY2FuY2VsQnViYmxlID0gdHJ1ZTtcbiAgICBldmVudC5yZXR1cm5WYWx1ZSA9IGZhbHNlO1xuXG4gICAgaWYgKGV2ZW50LmJ1dHRvbiA9PSAwIHx8IGV2ZW50LmJ1dHRvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmlzRHJhZ2dpbmcgPSB0cnVlO1xuICAgICAgdGhpcy5hdHRhY2hFdmVudExpc3RlbmVycygpO1xuICAgICAgdGhpcy5yZW1vdmVNZXNzYWdlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBsZXQgZXhwbGFuYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmV4cGxhbmF0aW9uLXdyYXBwZXJcIik7XG4gICAgICAgIGxldCBpbWFnZSA9IGV4cGxhbmF0aW9uLnF1ZXJ5U2VsZWN0b3IoXCJzcGFuID4gaW1nXCIpO1xuICAgICAgICBpZiAoIWltYWdlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGxldCB0ZXh0ID0gZXhwbGFuYXRpb24ucXVlcnlTZWxlY3RvcihcInNwYW4gPiBzcGFuXCIpO1xuICAgICAgICBleHBsYW5hdGlvbi5zdHlsZS5zZXRQcm9wZXJ0eShcImhlaWdodFwiLCBleHBsYW5hdGlvbi5vZmZzZXRIZWlnaHQgKyBcInB4XCIpO1xuICAgICAgICBpbWFnZS5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKGltYWdlKTtcbiAgICAgICAgdGV4dC5pbm5lckhUTUwgPSBcIlJlbGVhc2UgdG8gcGF1c2VcIjtcbiAgICAgIH0sIDMgKiAxMDAwKTtcbiAgICAgIGRpc2FibGVTY3JvbGwoKTtcblxuICAgICAgc3dpdGNoKHRoaXMuc3RhdGUpIHtcbiAgICAgICAgY2FzZSBTdGF0ZS5WSVJHSU46XG4gICAgICAgICAgdGhpcy5nYW1lV2luZG93LmNsYXNzTmFtZSA9IFwiXCI7XG4gICAgICAgICAgdGhpcy5sYXVuY2hCYWxsKCk7XG4gICAgICAgICAgXG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgU3RhdGUuTE9TVDpcbiAgICAgICAgICB0aGlzLnJlc2V0R2FtZSgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFN0YXRlLlBBVVNFRDpcbiAgICAgICAgICB0aGlzLnN0YXJ0TW92aW5nU21vb3RoKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucGxheSgpOyAgXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgZ2V0V2luZG93RGltZW5zaW9ucygpIHsgIFxuICAgIGxldCB3ID0gd2luZG93LFxuICAgICAgZCA9IGRvY3VtZW50LFxuICAgICAgZSA9IGQuZG9jdW1lbnRFbGVtZW50LFxuICAgICAgZyA9IGQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2JvZHknKVswXSxcbiAgICAgIHggPSB3LmlubmVyV2lkdGggfHwgZS5jbGllbnRXaWR0aCB8fCBnLmNsaWVudFdpZHRoLFxuICAgICAgeSA9IHcuaW5uZXJIZWlnaHR8fCBlLmNsaWVudEhlaWdodHx8IGcuY2xpZW50SGVpZ2h0O1xuICAgIHJldHVybiB7eCwgeX07XG4gIH1cblxuICBsYXVuY2hCYWxsKCkge1xuICAgIHRoaXMucGxheSgpO1xuICAgIHRoaXMubW92ZUJhbGwoKTtcbiAgfVxuXG4gIGdldEVsZW1lbnRPZmZzZXRUb3AoZWxlbWVudCkgeyAgICBcbiAgICBsZXQgZ2FtZVdpbmRvd0NzcyA9IGdldENvbXB1dGVkU3R5bGUodGhpcy5nYW1lV2luZG93KSxcbiAgICAgICAgYm9yZGVyV2lkdGggPSBwYXJzZUludChnYW1lV2luZG93Q3NzW1wiYm9yZGVyLXRvcC13aWR0aFwiXSk7XG4gICAgcmV0dXJuIHRoaXMuaXNGaXJlZm94ID8gZWxlbWVudC5vZmZzZXRUb3AgLSBib3JkZXJXaWR0aCA6IGVsZW1lbnQub2Zmc2V0VG9wO1xuICB9XG5cbiAgZ2V0RWxlbWVudE9mZnNldExlZnQoZWxlbWVudCkgeyAgICBcbiAgICBsZXQgZ2FtZVdpbmRvd0NzcyA9IGdldENvbXB1dGVkU3R5bGUodGhpcy5nYW1lV2luZG93KSxcbiAgICAgICAgYm9yZGVyV2lkdGggPSBwYXJzZUludChnYW1lV2luZG93Q3NzW1wiYm9yZGVyLWxlZnQtd2lkdGhcIl0pO1xuICAgIHJldHVybiB0aGlzLmlzRmlyZWZveCA/IGVsZW1lbnQub2Zmc2V0TGVmdCAtIGJvcmRlcldpZHRoIDogZWxlbWVudC5vZmZzZXRMZWZ0O1xuICB9XG5cbiAgcmVzZXRHYW1lKCkge1xuICAgIGlmICh0aGlzLnN0YXRlID09IFN0YXRlLkxPU1QpIHtcbiAgICAgIHRoaXMuZ2FtZVdpbmRvdy5jbGFzc0xpc3QucmVtb3ZlKFwibG9zdFwiKTtcbiAgICAgIC8vIGNoYW5nZSB0byBkaXNwbGF5ID0gYmxvY2sgbXVzdCBib21lIGJlZm9yZSBiYWxsLm9mZnNldEhlaWdodFxuICAgICAgLy8gYmVjYXVzZSBvZmZzZXRIZWlnaHQgZm9yIGVsZW1lbnRzIG5vdCBpbiB0aGUgRE9NIHdpbGwgYmUgMFxuICAgICAgdGhpcy5iYWxsLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG4gICAgICB0aGlzLmJhbGwuc3R5bGUubGVmdCA9IHRoaXMuZ2V0RWxlbWVudE9mZnNldExlZnQodGhpcy5wYWQpICsgKHRoaXMucGFkLm9mZnNldFdpZHRoIC0gdGhpcy5iYWxsLm9mZnNldFdpZHRoLzIpICsgXCJweFwiO1xuICAgICAgdGhpcy5iYWxsLnN0eWxlLnRvcCA9ICh0aGlzLmdldEVsZW1lbnRPZmZzZXRUb3AodGhpcy5wYWQucGFyZW50RWxlbWVudCkgLSB0aGlzLmJhbGwub2Zmc2V0SGVpZ2h0KSArIFwicHhcIjtcbiAgICAgIHRoaXMuc3RhdGUgPSBTdGF0ZS5SVU5OSU5HO1xuICAgICAgdGhpcy5nYW1lV2luZG93LmNsYXNzTmFtZSA9IFwiXCI7XG5cbiAgICAgIHRoaXMuc2V0dGluZ3MuYmFsbFNwZWVkID0gREVGQVVMVF9TUEVFRDtcblxuICAgICAgdGhpcy5kaXJlY3Rpb24gPSB7XG4gICAgICAgIHg6IDEsXG4gICAgICAgIHk6IDFcbiAgICAgIH07XG5cbiAgICAgIHRoaXMubGF1bmNoQmFsbCgpO1xuICAgIH1cbiAgfVxuXG4gIGVuZEdhbWUoKSB7XG4gICAgdGhpcy5zdGF0ZSA9IFN0YXRlLkxPU1Q7XG4gICAgdGhpcy5nYW1lV2luZG93LmNsYXNzTGlzdC5hZGQoXCJsb3N0XCIpO1xuICAgIHRoaXMuYmFsbC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gIH1cblxuICBzbG93QmFsbERvd24oY2IpIHtcblxuICAgIGxldCBpbnRlcnZhbCA9IHNldEludGVydmFsKCgpID0+IHtcbiAgICAgIGlmICh0aGlzLnNldHRpbmdzLmJhbGxTcGVlZC0tID09IDAgfHwgdGhpcy5pc0RyYWdnaW5nKSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICBjYigpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSwgMTAwKTtcbiAgfVxuXG4gIHN0YXJ0TW92aW5nU21vb3RoKGNiKSB7XG4gICAgY2IoKTtcbiAgICBpZiAodGhpcy5zZXR0aW5ncy5iYWxsU3BlZWQgPT0gREVGQVVMVF9TUEVFRCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBsZXQgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy5zZXR0aW5ncy5iYWxsU3BlZWQrKyA+PSA1KSB7XG4gICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuICAgICAgICAvLyBoYWNrIGZvciBidWcgcmVzaXN0YW5jZSBCLXxcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5iYWxsU3BlZWQgPSBERUZBVUxUX1NQRUVEO1xuICAgICAgICB0aGlzLmdhbWVXaW5kb3cuY2xhc3NMaXN0LnJlbW92ZShcInBhdXNlZFwiKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0sIDEwMCk7XG4gIH1cblxuICBwYXVzZUdhbWUoKSB7XG4gICAgaWYgKHRoaXMuc3RhdGUgPT0gU3RhdGUuUlVOTklORykge1xuICAgICAgdGhpcy5zdGF0ZSA9IFN0YXRlLlBBVVNFRDtcbiAgICAgIFxuICAgIH1cbiAgfVxuXG4gIHBsYXkoKSB7XG4gICAgdGhpcy5zdGF0ZSA9IFN0YXRlLlJVTk5JTkc7XG4gICAgXG4gIH1cblxuICBjb2xsaXNpb24oJGRpdjEsICRkaXYyLCBhcmVOb3RFbGVtZW50cyA9IHRydWUpIHtcbiAgICBsZXQgY2lyY2xlMSwgY2lyY2xlMjtcblxuICAgIGlmICggYXJlTm90RWxlbWVudHMgKSB7XG4gICAgICBjaXJjbGUxID0ge1xuICAgICAgICByYWRpdXM6ICRkaXYxLm9mZnNldEhlaWdodC8yLCBcbiAgICAgICAgeDogdGhpcy5nZXRFbGVtZW50T2Zmc2V0TGVmdCgkZGl2MSkgKyAkZGl2MS5vZmZzZXRIZWlnaHQvMiwgXG4gICAgICAgIHk6IHRoaXMuZ2FtZVdpbmRvdy5vZmZzZXRIZWlnaHQgLSB0aGlzLmdldEVsZW1lbnRPZmZzZXRUb3AoJGRpdjEpIC0gJGRpdjEub2Zmc2V0V2lkdGgvMlxuICAgICAgfTtcbiAgICAgIGNpcmNsZTIgPSB7XG4gICAgICAgIHJhZGl1czogJGRpdjIub2Zmc2V0V2lkdGgvMixcbiAgICAgICAgeDogdGhpcy5nZXRFbGVtZW50T2Zmc2V0TGVmdCgkZGl2MikgKyAkZGl2Mi5vZmZzZXRXaWR0aC8yLCBcbiAgICAgICAgeTogdGhpcy5nYW1lV2luZG93Lm9mZnNldEhlaWdodCAtIHRoaXMuZ2V0RWxlbWVudE9mZnNldFRvcCgkZGl2MikgLSAkZGl2Mi5vZmZzZXRXaWR0aC8yXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICBjaXJjbGUxID0gJGRpdjE7XG4gICAgICBjaXJjbGUyID0gJGRpdjJcbiAgICB9XG5cbiAgICB2YXIgZHggPSBjaXJjbGUxLnggLSBjaXJjbGUyLng7XG4gICAgdmFyIGR5ID0gY2lyY2xlMS55IC0gY2lyY2xlMi55O1xuICAgIHZhciBkaXN0YW5jZSA9IE1hdGguc3FydChkeCAqIGR4ICsgZHkgKiBkeSk7XG5cbiAgICBsZXQgcmFkaXVzU3VtID0gY2lyY2xlMS5yYWRpdXMgKyBjaXJjbGUyLnJhZGl1cztcblxuICAgIGxldCBpc0NvbGxpc2lvbiA9IGRpc3RhbmNlIDw9IHJhZGl1c1N1bTtcbiAgICBjaXJjbGUxLnggLT0gY2lyY2xlMi54O1xuICAgIGNpcmNsZTEueSAtPSBjaXJjbGUyLnk7XG5cbiAgICBpZiAoaXNDb2xsaXNpb24pIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHg6IGNpcmNsZTEueCAvIE1hdGguYWJzKGNpcmNsZTEueCksXG4gICAgICAgIHk6IGNpcmNsZTEueSAvIE1hdGguYWJzKGNpcmNsZTEueSlcbiAgICAgIH07XG5cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIGJsaW5rQm9yZGVyKHNpZGUpIHtcbiAgICBpZiAoc2lkZSA9PSBcInBhZFwiKSByZXR1cm47XG4gICAgbGV0IHNhbml0emVkU2lkZSA9IHNpZGUudG9Mb3dlckNhc2UoKTtcbiAgICBzYW5pdHplZFNpZGUgPSBzYW5pdHplZFNpZGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzYW5pdHplZFNpZGUuc2xpY2UoMSk7XG4gICAgdGhpcy5nYW1lV2luZG93LnN0eWxlWydib3JkZXInICsgc2FuaXR6ZWRTaWRlICsgJ0NvbG9yJ10gPSBcImdyZXlcIjtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuZ2FtZVdpbmRvdy5zdHlsZVsnYm9yZGVyJyArIHNhbml0emVkU2lkZSArICdDb2xvciddID0gXCJ0cmFuc3BhcmVudFwiO1xuICAgIH0sIDEwMDApO1xuICB9XG5cbiAgYm91bmNlKCkge1xuICAgIGxldCB4ID0gdGhpcy5nYW1lV2luZG93Lm9mZnNldFdpZHRoLCBcbiAgICAgICAgeSA9IHRoaXMuZ2FtZVdpbmRvdy5vZmZzZXRIZWlnaHQ7XG5cbiAgICBpZiAodGhpcy5wYWQucGFyZW50RWxlbWVudC5vZmZzZXRUb3AgKyAxMCA8IHRoaXMuYmFsbC5vZmZzZXRUb3AgKyB0aGlzLmJhbGwub2Zmc2V0SGVpZ2h0KSB7XG4gICAgICB0aHJvdyAnTG9zdCc7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2V0RWxlbWVudE9mZnNldExlZnQodGhpcy5iYWxsKSA8PSAwICYmIHRoaXMuZGlyZWN0aW9uLnggPT09IC0xKSB7XG4gICAgICAgIHRoaXMuYmFsbC5zdHlsZS5zZXRQcm9wZXJ0eShcImxlZnRcIiwgMCk7XG4gICAgICAgIHRoaXMuZGlyZWN0aW9uLnggPSAxO1xuICAgICAgICByZXR1cm4gJ2xlZnQnO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmdldEVsZW1lbnRPZmZzZXRUb3AodGhpcy5iYWxsKSA8PSAwICYmIHRoaXMuZGlyZWN0aW9uLnkgPT09IDEpIHtcbiAgICAgICAgdGhpcy5iYWxsLnN0eWxlLnNldFByb3BlcnR5KFwidG9wXCIsIDApO1xuICAgICAgICB0aGlzLmRpcmVjdGlvbi55ID0gLTE7XG4gICAgICAgIHJldHVybiAndG9wJztcbiAgICB9XG5cbiAgICBpZiAodGhpcy5nZXRFbGVtZW50T2Zmc2V0TGVmdCh0aGlzLmJhbGwpID49IHggLSBwYXJzZUludCh0aGlzLmJhbGwub2Zmc2V0V2lkdGgpICYmIHRoaXMuZGlyZWN0aW9uLnggPT09IDEpIHtcbiAgICAgICAgdGhpcy5iYWxsLnN0eWxlLnNldFByb3BlcnR5KFwidG9wXCIsIHkgLSBwYXJzZUludCh0aGlzLmJhbGwub2Zmc2V0SGVpZ2h0KSk7XG4gICAgICAgIHRoaXMuZGlyZWN0aW9uLnggPSAtMTtcbiAgICAgICAgcmV0dXJuICdyaWdodCc7XG4gICAgfVxuICAgICBcblxuICAgIGlmICh0aGlzLmdldEVsZW1lbnRPZmZzZXRUb3AodGhpcy5iYWxsKSArIDIxID49IHkgLSBwYXJzZUludCh0aGlzLmJhbGwub2Zmc2V0SGVpZ2h0KSAmJiB0aGlzLmRpcmVjdGlvbi55ID09PSAtMSkge1xuICAgICAgICBpZiAodGhpcy5nZXRFbGVtZW50T2Zmc2V0TGVmdCh0aGlzLmJhbGwpID4gdGhpcy5nZXRFbGVtZW50T2Zmc2V0TGVmdCh0aGlzLnBhZCkgLSB0aGlzLmJhbGwub2Zmc2V0V2lkdGggLSA1ICYmIHRoaXMuZ2V0RWxlbWVudE9mZnNldExlZnQodGhpcy5iYWxsKSA8IHRoaXMuZ2V0RWxlbWVudE9mZnNldExlZnQodGhpcy5wYWQpICsgdGhpcy5wYWQub2Zmc2V0V2lkdGgpIHtcbiAgICAgICAgICAgIHRoaXMuZGlyZWN0aW9uLnkgPSAxO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3BhZCEhIScpO1xuICAgICAgICAgICAgcmV0dXJuICdwYWQnO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgXG5cbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICBraWxsQnJpY2soJGJyaWNrKSB7XG4gICAgJGJyaWNrLmNsYXNzTGlzdC5yZW1vdmUoXCJhbGl2ZVwiKTtcbiAgICBsZXQgdG9SZW1vdmU7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmJyaWNrcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHRtcCA9IHRoaXMuYnJpY2tzW2ldO1xuICAgICAgaWYgKCF0bXAuY2xhc3NMaXN0LmNvbnRhaW5zKCdhbGl2ZScpKSB7XG4gICAgICAgIHRvUmVtb3ZlID0gaTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5icmlja3Muc3BsaWNlKHRvUmVtb3ZlLCAxKTtcblxuICAgIGdhKCdzZW5kJywge1xuICAgICAgaGl0VHlwZTogJ2V2ZW50JyxcbiAgICAgIGV2ZW50Q2F0ZWdvcnk6ICdHYW1lJyxcbiAgICAgIGV2ZW50QWN0aW9uOiAnYnJva2VuJyxcbiAgICAgIGV2ZW50TGFiZWw6ICdCcmljayBIaXRzJyxcbiAgICAgIGV2ZW50VmFsdWU6ICRicmljay5kYXRhc2V0Lm5hbWVcbiAgICB9KTtcbiAgfVxuXG4gIHZpY3RvcnkoKSB7XG4gICAgdGhpcy5zdGF0ZSA9IFN0YXRlLldJTjtcbiAgICBsZXQgcGF1c2VJY29uID0gdGhpcy5iYWxsLnF1ZXJ5U2VsZWN0b3IoXCJpXCIpO1xuICAgIHBhdXNlSWNvbi5wYXJlbnRFbGVtZW50LnJlbW92ZUNoaWxkKHBhdXNlSWNvbik7XG5cbiAgICB0aGlzLmJhbGwuc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQtaW1hZ2UnLCBcInVybCgnL2Fzc2V0cy9pbWFnZXMvdmljdG9yeS5qcGcnKVwiKTtcbiAgICB0aGlzLmJhbGwuc3R5bGUuc2V0UHJvcGVydHkoJ2JhY2tncm91bmQtc2l6ZScsICdjb250YWluJyk7XG4gICAgdGhpcy5iYWxsLmNsYXNzTGlzdC5hZGQoXCJ2aWN0b3J5XCIpO1xuXG4gICAgbGV0IGV4cGxhbmF0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5leHBsYW5hdGlvbi13cmFwcGVyXCIpO1xuICAgIGxldCB0ZXh0ID0gZXhwbGFuYXRpb24ucXVlcnlTZWxlY3RvcihcInNwYW4gPiBzcGFuXCIpO1xuICAgIHRleHQuaW5uZXJIVE1MID0gXCJWIGlzIGZvciBWaWlpY3RvcnkhXCI7XG4gIH1cblxuICBtb3ZlQmFsbCgpIHtcbiAgICB0cnkge1xuXG4gICAgICBpZiAodGhpcy5zdGF0ZSA9PSBTdGF0ZS5XSU4pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5zdGF0ZSA9PSBTdGF0ZS5QQVVTRUQpIHtcbiAgICAgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsgdGhpcy5tb3ZlQmFsbCgpOyB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuc2V0dGluZ3MuYmFsbFNwZWVkOyBpKyspIHtcbiAgICAgICAgbGV0IGJvdW5jZVNpZGUgPSB0aGlzLmJvdW5jZSgpO1xuXG4gICAgICAgIGlmIChib3VuY2VTaWRlKSB7XG4gICAgICAgICAgICB0aGlzLmJsaW5rQm9yZGVyKGJvdW5jZVNpZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgbGV0IGxlZnQgPSAodGhpcy5nZXRFbGVtZW50T2Zmc2V0TGVmdCh0aGlzLmJhbGwpICsgdGhpcy5kaXJlY3Rpb24ueCkgKyBcInB4XCIsXG4gICAgICAgICAgICBhID0gdGhpcy5nZXRFbGVtZW50T2Zmc2V0VG9wKHRoaXMuYmFsbCksXG4gICAgICAgICAgICBiID0gdGhpcy5kaXJlY3Rpb24ueSAqIC0xLFxuICAgICAgICAgICAgdG9wID0gYSArIGIgKyBcInB4XCI7XG5cbiAgICAgICAgdGhpcy5iYWxsLnN0eWxlLnNldFByb3BlcnR5KFwibGVmdFwiLCBsZWZ0KTtcbiAgICAgICAgdGhpcy5iYWxsLnN0eWxlLnNldFByb3BlcnR5KFwidG9wXCIsIHRvcCk7XG5cbiAgICAgICAgbGV0IGJhbGxUb3AgPSB0aGlzLmdldEVsZW1lbnRPZmZzZXRUb3AodGhpcy5iYWxsKSxcbiAgICAgICAgICBsYXN0SWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJkaXYuaWNvbnMgLmljb246bGFzdC1jaGlsZFwiKSxcbiAgICAgICAgICB0b3BUaHJlc2hvbGQgPSB0aGlzLmdldEVsZW1lbnRPZmZzZXRUb3AobGFzdEljb24pICsgbGFzdEljb24ub2Zmc2V0SGVpZ2h0O1xuICAgICAgICBcbiAgICAgICAgaWYgKGJhbGxUb3AgPCB0b3BUaHJlc2hvbGQpIHtcblxuICAgICAgICAgIHRoaXMuYnJpY2tzLmZvckVhY2goKCRicmljaykgPT4ge1xuICAgICAgICAgICAgbGV0IGlzQ29sbGlzaW9uID0gdGhpcy5jb2xsaXNpb24odGhpcy5iYWxsLCAkYnJpY2spO1xuXG5cbiAgICAgICAgICAgIGlmIChpc0NvbGxpc2lvbi54IHx8IGlzQ29sbGlzaW9uLnkpIHtcbiAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuYmFsbFNwZWVkID09PSBERUZBVUxUX1NQRUVEKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5raWxsQnJpY2soJGJyaWNrKTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5icmlja3MubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICB0aGlzLnZpY3RvcnkoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIGlmIChpc0NvbGxpc2lvbi54KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24ueCA9IGlzQ29sbGlzaW9uLng7XG4gICAgICAgICAgICAgIH1cbiAgXG4gICAgICAgICAgICAgIGlmIChpc0NvbGxpc2lvbi55KSB7XG4gICAgICAgICAgICAgICAgdGhpcy5kaXJlY3Rpb24ueSA9IGlzQ29sbGlzaW9uLnk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gXG4gICAgICB9XG5cbiAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgoKSA9PiB7IHRoaXMubW92ZUJhbGwoKTsgfSk7XG4gICAgfSAgY2F0Y2goZSkge1xuICAgICAgICBpZiAoZSA9PT0gXCJMb3N0XCIpIHtcbiAgICAgICAgICAgIHRoaXMuZW5kR2FtZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5lbmRHYW1lKCk7XG4gICAgICAgICAgICB0aHJvdyAoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ==
